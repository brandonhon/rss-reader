<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FeedFlow - Preferences</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/preferences.css">
</head>
<body>
    <div class="preferences-container">
        <!-- Header -->
        <div class="preferences-header">
            <div class="header-content">
                <div>
                    <a href="/" class="back-link">
                        <span>‚Üê</span>
                        <span>Back to FeedFlow</span>
                    </a>
                    <h1 class="header-title">Preferences</h1>
                    <p class="header-subtitle">Customize your FeedFlow experience</p>
                </div>
                <div class="save-indicator" id="saveIndicator">
                    ‚úì Saved automatically
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="preferences-nav">
            <div class="nav-tabs">
                <button class="nav-tab active" data-tab="general">
                    <span class="tab-icon">‚öôÔ∏è</span>
                    <span>General</span>
                </button>
                <button class="nav-tab" data-tab="appearance">
                    <span class="tab-icon">üé®</span>
                    <span>Appearance</span>
                </button>
                <button class="nav-tab" data-tab="feeds">
                    <span class="tab-icon">üì∞</span>
                    <span>Feeds</span>
                </button>
                <button class="nav-tab" data-tab="notifications">
                    <span class="tab-icon">üîî</span>
                    <span>Notifications</span>
                </button>
                <button class="nav-tab" data-tab="account">
                    <span class="tab-icon">üë§</span>
                    <span>Account</span>
                </button>
            </div>
        </div>

        <!-- Content -->
        <div class="preferences-content">
            <!-- General Tab -->
            <div class="tab-panel active" id="general-tab">
                <div class="settings-section">
                    <div class="section-header">
                        <h2 class="section-title">General Settings</h2>
                        <p class="section-description">Configure basic application behavior and preferences</p>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Default View</label>
                        <p class="form-description">Choose what you see when opening FeedFlow</p>
                        <select class="form-select">
                            <option value="all">All Articles</option>
                            <option value="unread">Unread Articles</option>
                            <option value="starred">Starred Articles</option>
                            <option value="today">Today's Articles</option>
                        </select>
                    </div>

                    <div class="toggle-group">
                        <div class="toggle-info">
                            <div class="toggle-label">Auto-mark as read</div>
                            <div class="toggle-description">Automatically mark articles as read when opened</div>
                        </div>
                        <div class="toggle-switch active">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>

                    <div class="toggle-group">
                        <div class="toggle-info">
                            <div class="toggle-label">Show article previews</div>
                            <div class="toggle-description">Display article excerpts in the list view</div>
                        </div>
                        <div class="toggle-switch active">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>

                    <div class="toggle-group">
                        <div class="toggle-info">
                            <div class="toggle-label">Keyboard shortcuts</div>
                            <div class="toggle-description">Enable keyboard navigation and shortcuts</div>
                        </div>
                        <div class="toggle-switch active">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Appearance Tab -->
            <div class="tab-panel" id="appearance-tab">
                <div class="settings-section">
                    <div class="section-header">
                        <h2 class="section-title">Theme</h2>
                        <p class="section-description">Choose your preferred color scheme</p>
                    </div>

                    <div class="theme-previews">
                        <div class="theme-preview theme-light active">
                            <div class="theme-header">
                                <div class="theme-dot"></div>
                                <div class="theme-dot"></div>
                                <div class="theme-dot"></div>
                            </div>
                            <div class="theme-body">
                                <div class="theme-sidebar"></div>
                                <div class="theme-content">
                                    <div class="theme-line" style="width: 80%;"></div>
                                    <div class="theme-line" style="width: 60%;"></div>
                                    <div class="theme-line" style="width: 90%;"></div>
                                </div>
                            </div>
                        </div>

                        <div class="theme-preview theme-dark">
                            <div class="theme-header">
                                <div class="theme-dot"></div>
                                <div class="theme-dot"></div>
                                <div class="theme-dot"></div>
                            </div>
                            <div class="theme-body">
                                <div class="theme-sidebar"></div>
                                <div class="theme-content">
                                    <div class="theme-line" style="width: 80%;"></div>
                                    <div class="theme-line" style="width: 60%;"></div>
                                    <div class="theme-line" style="width: 90%;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="section-header">
                        <h2 class="section-title">Layout</h2>
                        <p class="section-description">Customize the interface layout</p>
                    </div>

                    <div class="toggle-group">
                        <div class="toggle-info">
                            <div class="toggle-label">Compact view</div>
                            <div class="toggle-description">Use smaller spacing and fonts for more content</div>
                        </div>
                        <div class="toggle-switch">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Feeds Tab -->
            <div class="tab-panel" id="feeds-tab">
                <div class="settings-section">
                    <div class="section-header">
                        <h2 class="section-title">Category Management</h2>
                        <p class="section-description">Organize your feeds into categories</p>
                    </div>

                    <div id="categories-list" class="categories-container">
                        <!-- Categories will be populated by JavaScript -->
                    </div>
                    <button class="btn btn-outline" onclick="openAddCategoryModal()">
                        <span class="btn-icon">üìÅ</span>
                        Add Category
                    </button>
                </div>

                <div class="settings-section">
                    <div class="section-header">
                        <h2 class="section-title">Import/Export</h2>
                        <p class="section-description">Manage your feed subscriptions</p>
                    </div>

                    <div class="import-export-controls">
                        <div class="control-group">
                            <button class="btn btn-outline" onclick="exportOPML()">
                                <span class="btn-icon">üíæ</span>
                                Export OPML
                            </button>
                            <p class="control-description">Export all your feeds to an OPML file</p>
                        </div>
                        <div class="control-group">
                            <input type="file" id="opml-import-input" accept=".opml,.xml" style="display: none;">
                            <button class="btn btn-outline" onclick="document.getElementById('opml-import-input').click()">
                                <span class="btn-icon">üìÅ</span>
                                Import OPML
                            </button>
                            <p class="control-description">Import feeds from an OPML file</p>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="section-header">
                        <h2 class="section-title">My Feeds</h2>
                        <p class="section-description">Manage your RSS feeds and subscriptions</p>
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="openAddFeedModal()">
                            <span>+</span>
                            <span>Add New Feed</span>
                        </button>
                        <button class="btn btn-secondary" onclick="openUnsubscribeModal()">
                            <span>üóëÔ∏è</span>
                            <span>Unsubscribe</span>
                        </button>
                    </div>

                    <div id="feeds-by-category" class="feeds-container feeds-scrollable">
                        <!-- Feeds will be populated by JavaScript -->
                    </div>
                </div>

                <div class="settings-section">
                    <div class="section-header">
                        <h2 class="section-title">Update Settings</h2>
                        <p class="section-description">Configure how often feeds are updated</p>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Update Interval</label>
                        <p class="form-description">How often to check for new articles</p>
                        <select class="form-select">
                            <option value="5">Every 5 minutes</option>
                            <option value="15" selected>Every 15 minutes</option>
                            <option value="30">Every 30 minutes</option>
                            <option value="60">Every hour</option>
                            <option value="240">Every 4 hours</option>
                            <option value="720">Every 12 hours</option>
                        </select>
                    </div>

                    <div class="toggle-group">
                        <div class="toggle-info">
                            <div class="toggle-label">Background updates</div>
                            <div class="toggle-description">Continue updating feeds when the app is in the background</div>
                        </div>
                        <div class="toggle-switch active">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notifications Tab -->
            <div class="tab-panel" id="notifications-tab">
                <div class="settings-section">
                    <div class="section-header">
                        <h2 class="section-title">Desktop Notifications</h2>
                        <p class="section-description">Control when and how you receive notifications</p>
                    </div>

                    <div class="toggle-group">
                        <div class="toggle-info">
                            <div class="toggle-label">Enable notifications</div>
                            <div class="toggle-description">Show desktop notifications for new articles</div>
                        </div>
                        <div class="toggle-switch active">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>

                    <div class="toggle-group">
                        <div class="toggle-info">
                            <div class="toggle-label">Sound alerts</div>
                            <div class="toggle-description">Play a sound when new articles arrive</div>
                        </div>
                        <div class="toggle-switch">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Account Tab -->
            <div class="tab-panel" id="account-tab">
                <div class="settings-section">
                    <div class="section-header">
                        <h2 class="section-title">Profile</h2>
                        <p class="section-description">Manage your account information</p>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Username</label>
                        <input type="text" class="form-input" value="{{.Username}}" readonly>
                    </div>

                    <div class="btn-group">
                        <button class="btn btn-primary">Update Profile</button>
                        <button class="btn btn-secondary">Change Password</button>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="section-header">
                        <h2 class="section-title">Statistics</h2>
                        <p class="section-description">Your FeedFlow usage statistics</p>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="articles-count">--</div>
                            <div class="stat-label">Total Articles</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="feeds-count">--</div>
                            <div class="stat-label">Feeds</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="categories-count">--</div>
                            <div class="stat-label">Categories</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="system-uptime">--</div>
                            <div class="stat-label">Uptime</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Feed Modal -->
    <div id="add-feed-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Add New Feed</h2>
            </div>
            <div class="modal-body">
                <form id="add-feed-form">
                    <div class="form-group">
                        <label class="form-label">Feed URL</label>
                        <input type="url" name="url" class="form-input" placeholder="https://example.com/rss.xml" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select name="category" id="feed-category" class="form-select" required>
                            <option value="">Select a category</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            <input type="checkbox" id="feed-auth-enabled"> 
                            Requires Authentication
                        </label>
                    </div>
                    <div id="auth-fields" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">Username</label>
                            <input type="text" name="username" class="form-input">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Password</label>
                            <input type="password" name="password" class="form-input">
                        </div>
                    </div>
                    <div class="btn-group">
                        <button type="button" class="btn btn-secondary" onclick="closeAddFeedModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">Add Feed</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Unsubscribe Modal -->
    <div id="unsubscribe-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Unsubscribe from Feeds</h2>
            </div>
            <div class="modal-body">
                <div id="unsubscribe-feeds">
                    <!-- Feeds will be populated by JavaScript -->
                </div>
                <div class="btn-group">
                    <button type="button" class="btn btn-secondary" onclick="closeUnsubscribeModal()">Cancel</button>
                    <button type="button" class="btn btn-primary" id="unsubscribe-btn" disabled onclick="unsubscribeSelected()">Unsubscribe Selected</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/preferences.js"></script>
</body>
</html>