<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preferences - RSS Reader</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/preferences.css">
</head>
<body>
    <div class="preferences-container">
        <!-- Header -->
        <header class="preferences-header">
            <div class="header-content">
                <div class="header-left">
                    <a href="/" class="back-button">
                        <span class="back-icon">‚Üê</span>
                        <span>Back to Reader</span>
                    </a>
                    <h1 class="preferences-title">Preferences</h1>
                </div>
                <div class="header-right">
                    <span class="user-info">{{.Username}}</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="preferences-content">
            <!-- Navigation Sidebar -->
            <nav class="preferences-nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <button class="nav-button active" data-tab="general">
                            <span class="nav-icon">‚öôÔ∏è</span>
                            <span class="nav-label">General</span>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-button" data-tab="feeds">
                            <span class="nav-icon">üì°</span>
                            <span class="nav-label">Feeds</span>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-button" data-tab="users">
                            <span class="nav-icon">üë•</span>
                            <span class="nav-label">Users</span>
                        </button>
                    </li>
                    <li class="nav-item">
                        <button class="nav-button" data-tab="system">
                            <span class="nav-icon">üñ•Ô∏è</span>
                            <span class="nav-label">System</span>
                        </button>
                    </li>
                </ul>
            </nav>

            <!-- Tab Content -->
            <main class="preferences-main">
                <!-- General Tab -->
                <div class="tab-content active" id="general-tab">
                    <div class="tab-header">
                        <h2 class="tab-title">General Preferences</h2>
                        <p class="tab-description">Configure general application settings</p>
                    </div>

                    <div class="settings-section">
                        <h3 class="section-title">Appearance</h3>
                        <div class="setting-group">
                            <label class="setting-label">Theme</label>
                            <div class="setting-control">
                                <div class="theme-options">
                                    <button class="theme-option" data-theme="light">
                                        <span class="theme-icon">‚òÄÔ∏è</span>
                                        <span class="theme-name">Light</span>
                                    </button>
                                    <button class="theme-option" data-theme="dark">
                                        <span class="theme-icon">üåô</span>
                                        <span class="theme-name">Dark</span>
                                    </button>
                                    <button class="theme-option" data-theme="auto">
                                        <span class="theme-icon">üåì</span>
                                        <span class="theme-name">Auto</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="setting-group">
                            <label class="setting-label" for="language-select">Language</label>
                            <div class="setting-control">
                                <select id="language-select" class="setting-select">
                                    <option value="en" selected>English</option>
                                    <option value="es">Espa√±ol</option>
                                    <option value="fr">Fran√ßais</option>
                                    <option value="de">Deutsch</option>
                                    <option value="it">Italiano</option>
                                    <option value="pt">Portugu√™s</option>
                                    <option value="ja">Êó•Êú¨Ë™û</option>
                                    <option value="zh">‰∏≠Êñá</option>
                                </select>
                            </div>
                        </div>

                        <div class="setting-group">
                            <label class="setting-label" for="timezone-select">Time Zone</label>
                            <div class="setting-control">
                                <select id="timezone-select" class="setting-select">
                                    <option value="UTC">UTC</option>
                                    <option value="America/New_York">Eastern Time (US)</option>
                                    <option value="America/Chicago">Central Time (US)</option>
                                    <option value="America/Denver">Mountain Time (US)</option>
                                    <option value="America/Los_Angeles" selected>Pacific Time (US)</option>
                                    <option value="Europe/London">London</option>
                                    <option value="Europe/Paris">Paris</option>
                                    <option value="Europe/Berlin">Berlin</option>
                                    <option value="Asia/Tokyo">Tokyo</option>
                                    <option value="Asia/Shanghai">Shanghai</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 class="section-title">Updates</h3>
                        <div class="setting-group">
                            <label class="setting-label" for="update-interval">Default Update Interval</label>
                            <div class="setting-control">
                                <select id="update-interval" class="setting-select">
                                    <option value="5">Every 5 minutes</option>
                                    <option value="15" selected>Every 15 minutes</option>
                                    <option value="30">Every 30 minutes</option>
                                    <option value="60">Every hour</option>
                                    <option value="240">Every 4 hours</option>
                                    <option value="720">Every 12 hours</option>
                                    <option value="1440">Once daily</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Feeds Tab -->
                <div class="tab-content" id="feeds-tab">
                    <div class="tab-header">
                        <h2 class="tab-title">Feed Management</h2>
                        <p class="tab-description">Manage your RSS feeds and subscriptions</p>
                        <div class="tab-actions">
                            <button class="btn btn-secondary" onclick="openAddFeedModal()">
                                <span class="btn-icon">‚ûï</span>
                                Add Feed
                            </button>
                            <button class="btn btn-secondary" onclick="openUnsubscribeModal()">
                                <span class="btn-icon">üóëÔ∏è</span>
                                Unsubscribe
                            </button>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 class="section-title">Category Management</h3>
                        <div class="category-management">
                            <div id="categories-list" class="categories-container">
                                <!-- Categories will be populated by JavaScript -->
                            </div>
                            <button class="btn btn-outline" onclick="openAddCategoryModal()">
                                <span class="btn-icon">üìÅ</span>
                                Add Category
                            </button>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 class="section-title">Import/Export</h3>
                        <div class="import-export-controls">
                            <div class="control-group">
                                <button class="btn btn-outline" onclick="exportOPML()">
                                    <span class="btn-icon">üíæ</span>
                                    Export OPML
                                </button>
                                <p class="control-description">Export all your feeds to an OPML file</p>
                            </div>
                            <div class="control-group">
                                <input type="file" id="opml-import-input" accept=".opml,.xml" style="display: none;">
                                <button class="btn btn-outline" onclick="document.getElementById('opml-import-input').click()">
                                    <span class="btn-icon">üìÅ</span>
                                    Import OPML
                                </button>
                                <p class="control-description">Import feeds from an OPML file</p>
                            </div>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 class="section-title">My Feeds</h3>
                        <div id="feeds-by-category" class="feeds-container feeds-scrollable">
                            <!-- Feeds will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Users Tab -->
                <div class="tab-content" id="users-tab">
                    <div class="tab-header">
                        <h2 class="tab-title">User Management</h2>
                        <p class="tab-description">Manage user accounts and permissions</p>
                    </div>

                    <div class="settings-section">
                        <h3 class="section-title">Current User</h3>
                        <div class="user-profile">
                            <div class="profile-info">
                                <div class="profile-avatar">{{printf "%.1s" .Username}}</div>
                                <div class="profile-details">
                                    <h4 class="profile-name">{{.Username}}</h4>
                                    <p class="profile-role">Administrator</p>
                                </div>
                            </div>
                            <button class="btn btn-outline">Change Password</button>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 class="section-title">Account Settings</h3>
                        <div class="setting-group">
                            <label class="setting-label">Email Notifications</label>
                            <div class="setting-control">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="email-notifications">
                                    <span class="toggle-slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- System Tab -->
                <div class="tab-content" id="system-tab">
                    <div class="tab-header">
                        <h2 class="tab-title">System Information</h2>
                        <p class="tab-description">System status and configuration</p>
                    </div>

                    <div class="settings-section">
                        <h3 class="section-title">Application Info</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Version</span>
                                <span class="info-value">v0.3.0</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Database</span>
                                <span class="info-value">SQLite</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Uptime</span>
                                <span class="info-value" id="system-uptime">--</span>
                            </div>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 class="section-title">Storage</h3>
                        <div class="storage-info">
                            <div class="storage-item">
                                <span class="storage-label">Articles</span>
                                <span class="storage-value" id="articles-count">--</span>
                            </div>
                            <div class="storage-item">
                                <span class="storage-label">Feeds</span>
                                <span class="storage-value" id="feeds-count">--</span>
                            </div>
                            <div class="storage-item">
                                <span class="storage-label">Categories</span>
                                <span class="storage-value" id="categories-count">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Add Feed Modal -->
    <div id="add-feed-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Subscribe to Feed</h3>
                <button class="modal-close" onclick="closeAddFeedModal()">√ó</button>
            </div>
            <form id="add-feed-form" class="modal-body">
                <div class="form-group">
                    <label for="feed-url" class="form-label">Feed URL *</label>
                    <input type="url" id="feed-url" name="url" class="form-input" 
                           placeholder="https://example.com/rss.xml" required>
                    <p class="form-help">Enter the RSS/Atom feed URL</p>
                </div>

                <div class="form-group">
                    <label for="feed-category" class="form-label">Category *</label>
                    <select id="feed-category" name="category" class="form-select" required>
                        <option value="">Select a category</option>
                        <!-- Categories populated by JavaScript -->
                    </select>
                    <p class="form-help">Choose which category to place this feed in</p>
                </div>

                <div class="form-group">
                    <label for="feed-update-interval" class="form-label">Update Interval</label>
                    <select id="feed-update-interval" name="updateInterval" class="form-select">
                        <option value="0">Use default (15 minutes)</option>
                        <option value="5">Every 5 minutes</option>
                        <option value="15">Every 15 minutes</option>
                        <option value="30">Every 30 minutes</option>
                        <option value="60">Every hour</option>
                        <option value="240">Every 4 hours</option>
                        <option value="720">Every 12 hours</option>
                        <option value="1440">Once daily</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Authentication (Optional)</label>
                    <div class="auth-section">
                        <label class="toggle-switch">
                            <input type="checkbox" id="feed-auth-enabled">
                            <span class="toggle-slider"></span>
                            <span class="toggle-label">Requires authentication</span>
                        </label>
                        
                        <div id="auth-fields" class="auth-fields" style="display: none;">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="feed-username" class="form-label">Username</label>
                                    <input type="text" id="feed-username" name="username" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="feed-password" class="form-label">Password</label>
                                    <input type="password" id="feed-password" name="password" class="form-input">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeAddFeedModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Subscribe</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Unsubscribe Modal -->
    <div id="unsubscribe-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Unsubscribe from Feeds</h3>
                <button class="modal-close" onclick="closeUnsubscribeModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p class="modal-description">Select feeds to unsubscribe from. You can select multiple feeds.</p>
                
                <div id="unsubscribe-feeds" class="unsubscribe-container">
                    <!-- Feed list populated by JavaScript -->
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeUnsubscribeModal()">Cancel</button>
                    <button type="button" class="btn btn-danger" onclick="unsubscribeSelected()" id="unsubscribe-btn" disabled>
                        Unsubscribe Selected
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/preferences.js"></script>
</body>
</html>